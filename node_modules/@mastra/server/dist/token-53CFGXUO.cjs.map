{"version":3,"sources":["../../../node_modules/.pnpm/@vercel+oidc@3.0.1/node_modules/@vercel/oidc/dist/token.js"],"names":["__commonJS","require_token_error","require_token_util"],"mappings":"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","file":"token-53CFGXUO.cjs","sourcesContent":["\"use strict\";\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toCommonJS = (mod) => __copyProps(__defProp({}, \"__esModule\", { value: true }), mod);\nvar token_exports = {};\n__export(token_exports, {\n  refreshToken: () => refreshToken\n});\nmodule.exports = __toCommonJS(token_exports);\nvar import_token_error = require(\"./token-error\");\nvar import_token_util = require(\"./token-util\");\nasync function refreshToken() {\n  const { projectId, teamId } = (0, import_token_util.findProjectInfo)();\n  let maybeToken = (0, import_token_util.loadToken)(projectId);\n  if (!maybeToken || (0, import_token_util.isExpired)((0, import_token_util.getTokenPayload)(maybeToken.token))) {\n    const authToken = (0, import_token_util.getVercelCliToken)();\n    if (!authToken) {\n      throw new import_token_error.VercelOidcTokenError(\n        \"Failed to refresh OIDC token: login to vercel cli\"\n      );\n    }\n    if (!projectId) {\n      throw new import_token_error.VercelOidcTokenError(\n        \"Failed to refresh OIDC token: project id not found\"\n      );\n    }\n    maybeToken = await (0, import_token_util.getVercelOidcToken)(authToken, projectId, teamId);\n    if (!maybeToken) {\n      throw new import_token_error.VercelOidcTokenError(\"Failed to refresh OIDC token\");\n    }\n    (0, import_token_util.saveToken)(maybeToken, projectId);\n  }\n  process.env.VERCEL_OIDC_TOKEN = maybeToken.token;\n  return;\n}\n// Annotate the CommonJS export names for ESM import in node:\n0 && (module.exports = {\n  refreshToken\n});\n"]}